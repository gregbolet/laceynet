<html>
  <head>
    <!-- Load Bootstrap/CSS/Popper/Jquery/Socket.io -->
    <link rel="stylesheet" href="bootstrap.min.css"> </link>
    <script src="jquery-3.6.0.min.js"></script>
    <script src="popper.min.js" ></script>
    <script src="bootstrap.min.js" ></script>
    <script src="/socket.io/socket.io.js"></script>

    <title>Guessing Game!</title>
  </head>


  <body>
    <p id="server-time"></p>

    <div class="container" style="width:100%; height:100%;">
      <div class="col-md-12 text-center align-middle" style="width:100%; height:100%;">
        <button id="mainbutton" type="button" class="btn btn-primary btn-block" style="font-size:500%; width:100%; height:100%; height:50%; position: absolute; top:25%;">
          TEST BUTTON	
        </button>
      </div>
    </div>

  </body>

  <script>

    // Use JQuery to grab our button object
    var button = $( "#mainbutton" );

    function setContinueMode(){
          button.removeClass( "btn-warning" );
          button.addClass( "btn-primary" );
        }

    function setRestartMode(){
          button.removeClass( "btn-danger" )
          button.removeClass( "btn-primary" )
          button.removeClass( "btn-success" )
          button.addClass( "btn-warning" )
        }

    function setLoserMode(){
          button.removeClass( "btn-primary" )
          button.addClass( "btn-danger" )
        }

    function setWinnerMode(){
          button.removeClass( "btn-primary" )
          button.addClass( "btn-success" )
        }

    // URL defaults to window.location
    let socket = io();
    let el;

    socket.on('time', (timeString) => {
          el = document.getElementById('server-time');
          el.innerHTML = 'Server time: ' + timeString;
        });

    // Handle incoming messages
    socket.on('command', (msg) => {
          console.log(msg);

          let command = msg.command;
          if(command == 'restart'){
                console.log('RESTARTING GAME');
                setRestartMode();
              }
          else if(command == 'update'){
                console.log('Got a state update!');
                let clientData = msg.clientData;
                let currIdx = clientData.currIdx;
                //let 

                // Check if we should fail the game
                //if(currIdx >= ){

                //}


                setContinueMode();
              }

        });

    // Setup the outgoing message handlers
    var clientId = -1;
    var didGameOver = false;

    // When the main button is pressed, do something
    button.click(function() {
          console.log('button was clicked');
          socket.emit("clicked", {myState: didGameOver});
        });

  </script>

</html>
